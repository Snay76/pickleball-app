<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Pickleball</title>

  <!-- IMPORTANT: utilise style.css (cache-busting) -->
  <link rel="stylesheet" href="style.css?v=20260123-1" />
</head>

<body>
  <!-- Topbar -->
  <div class="topbar">
    <div class="brand">
      <div style="font-weight:950">Pickleball</div>
      <small id="versionText">Version: …</small>
    </div>
    <div id="authBadge" class="authMini" title="Compte (clique)">
      <span id="authDot" class="dot"></span>
      <span id="authEmail" class="authEmail">(non connecté)</span>
    </div>
  </div>

  <!-- LOGIN -->
  <div id="loginCard" class="card">
    <h2>Connexion</h2>
    <div class="row">
      <div class="col">
        <label for="email">Courriel</label>
        <input id="email" type="email" placeholder="nom@exemple.com" autocomplete="email" inputmode="email" />
      </div>
      <div class="col">
        <button id="loginBtn" class="btnPrimary btnBlock" type="button">Recevoir un lien</button>
      </div>
    </div>
    <div class="help">
      Tu reçois un lien par courriel. Clique-le pour ouvrir l’app.
    </div>
    <div class="hr"></div>
    <div id="loginStatus" class="status">Prêt.</div>
  </div>

  <!-- APP -->
  <div id="appCard" class="card hidden">
    <!-- Venue bar (CSS dans style.css) -->
    <div id="venueBar" class="venueBar hidden">
      <div class="label">Lieu sélectionné</div>
      <div class="value" id="venueBarValue">—</div>
    </div>

    <div class="tabs">
      <button class="tab active" data-tab="tabPlayers" type="button">Joueurs</button>
      <button class="tab" data-tab="tabMatches" type="button">Matchs</button>
      <button class="tab" data-tab="tabDebug" type="button">Debug</button>
    </div>

    <!-- Joueurs -->
    <div id="tabPlayers" style="margin-top:12px;">
      <h3>Lieu / Session</h3>
      <div class="row">
        <div class="col">
          <label for="venueSelect">Lieu</label>
          <select id="venueSelect"></select>
        </div>
      </div>

      <h3>Ajouter un joueur au lieu</h3>
      <div class="row">
        <div class="col">
          <label for="playerName">Nom complet</label>
          <input id="playerName" type="text" placeholder="Ex: Titi Pellerin" />
        </div>
        <div class="col">
          <button id="addPlayerBtn" class="btnBlock btnPrimary" type="button">Ajouter joueur</button>
        </div>
      </div>

      <h3>Liste des joueurs</h3>
      <div id="playersEmpty" class="muted">Chargement…</div>
      <div id="playersWrap"></div>
    </div>

    <!-- Matchs -->
    <div id="tabMatches" class="hidden" style="margin-top:12px;">
      <h3>Affichage</h3>
      <div class="row">
        <div class="col">
          <label for="matchFilter">Filtres</label>
          <select id="matchFilter">
            <option value="today_all">Aujourd’hui – tous</option>
            <option value="today_inprogress">Aujourd’hui – en cours</option>
            <option value="today_mine">Aujourd’hui – mes matchs</option>
          </select>
        </div>
        <div class="col">
          <label for="matchMode">Type de partie</label>
          <select id="matchMode">
            <option value="2">Simple (2 joueurs)</option>
            <option value="4" selected>Double (4 joueurs)</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div class="col" style="flex:0 0 260px;">
          <button id="suggestTeamsBtn" type="button">Proposer équipes (aléatoire)</button>
        </div>
        <div class="col" style="flex:0 0 320px;">
          <button id="finishAllTodayBtn" class="btnBlock btnDanger" type="button">Terminer tous les matchs du jour</button>
        </div>
      </div>

      <div class="hr"></div>
      <h3>Créer un match</h3>

      <div class="row">
        <div class="col">
          <label for="court">Terrain</label>
          <select id="court"></select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label for="a1">A1</label>
          <select id="a1"></select>
        </div>
        <div class="col">
          <label for="a2">A2</label>
          <select id="a2"></select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <label for="b1">B1</label>
          <select id="b1"></select>
        </div>
        <div class="col">
          <label for="b2">B2</label>
          <select id="b2"></select>
        </div>
      </div>

      <div class="row">
        <div class="col">
          <button id="createMatchBtn" class="btnBlock btnPrimary" type="button">Créer match</button>
        </div>
      </div>

      <div class="hr"></div>
      <h3>Matchs</h3>
      <div id="matchesEmpty" class="muted">Chargement…</div>
      <div id="matchesWrap"></div>
    </div>

    <!-- Debug -->
    <div id="tabDebug" class="hidden" style="margin-top:12px;">
      <h3>Debug</h3>
      <div id="debug" class="status">…</div>
    </div>
  </div>

  <!-- SCORE OVERLAY -->
  <div id="scoreOverlay" class="overlay hidden" role="dialog" aria-modal="true">
    <div class="modal">
      <div class="modalHead">
        <strong>Terminer le match</strong>
        <button id="scoreCloseBtn" class="iconBtn" type="button" title="Fermer">✕</button>
      </div>

      <div class="hr"></div>
      <div id="scoreMatchInfo" class="status">…</div>

      <div class="row" style="margin-top:10px;">
        <div class="col">
          <label for="scoreA">Score Équipe A</label>
          <input id="scoreA" type="number" inputmode="numeric" placeholder="0" />
        </div>
        <div class="col">
          <label for="scoreB">Score Équipe B</label>
          <input id="scoreB" type="number" inputmode="numeric" placeholder="0" />
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div class="col">
          <label for="finishStatus">Statut</label>
          <select id="finishStatus">
            <option value="done" selected>terminée</option>
            <option value="abandoned">abandonnée</option>
          </select>
        </div>
      </div>

      <div class="row" style="margin-top:10px;">
        <div class="col" style="flex:0 0 260px;">
          <button id="scoreConfirmBtn" class="btnPrimary" type="button">Confirmer (Enter)</button>
        </div>
        <div class="col" style="flex:0 0 260px;">
          <button id="scoreNoScoreBtn" type="button">Confirmer sans score</button>
        </div>
      </div>

      <div class="hr"></div>
      <div id="scoreStatus" class="status">…</div>
    </div>
  </div>

  <!-- JS -->
  <script type="module" src="js/main.js?v=20260123-1"></script>

  <!-- Bottom version (fix: pas de "..." invalide) -->
  <div id="versionTextBottom"
       style="position:fixed;bottom:10px;left:10px;right:10px;font-size:12px;color:rgba(232,239,255,.45);text-align:center;pointer-events:none;">
  </div>
</body>
</html>
